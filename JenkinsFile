pipeline { agent any // Run on any available Jenkins agent (can be Docker, bare metal, etc.) tools { nodejs "NodeJS_20" // Use NodeJS tool defined in Jenkins UI (Global Tool Config) } environment { DOCKER_COMPOSE = "docker-compose" // Just a shortcut variable } stages { stage('Checkout') { steps { // Pulls code from your GitHub repo git branch: 'main', url: 'https://github.com/your-username/KONG-CYPRESS-TESTS.git' } } stage('Start Kong Gateway') { steps { // Spin up Kong containers sh "${DOCKER_COMPOSE} up -d" // Wait for services to be available sh "sleep 15" } } stage('Install Dependencies') { steps { // Install Cypress + mochawesome dependencies sh 'npm install' } } stage('Run Cypress Tests') { steps { // Run Cypress test for service creation sh 'npx cypress run --spec "cypress/e2e/kong-service.cy.js"' } post { always { // Save artifacts (JSON + HTML reports) archiveArtifacts artifacts: 'cypress/reports/*.json, cypress/reports/*.html', fingerprint: true } } } stage('Generate HTML Report') { steps { // Run custom generate-report.js script sh 'npm run generate-report' } } stage('Publish Report') { steps { // Publish mochawesome HTML report to Jenkins job UI publishHTML([[ reportDir: 'cypress/reports', reportFiles: 'mochawesome.html', reportName: 'Cypress Test Report' ]]) } } stage('Teardown') { steps { // Stop and clean up Docker containers sh "${DOCKER_COMPOSE} down" } } } post { always { echo " Pipeline finished. Reports available in Jenkins UI." } } }
